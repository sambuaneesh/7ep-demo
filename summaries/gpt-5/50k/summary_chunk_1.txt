Architectural summary (Codebase chunk 1 of 3)

High-level system
- Type: Java monolithic web application (server-side rendering) packaged as a WAR, run on Tomcat (via Gradle/Gretty during development). Includes a separate Swing desktop demo app with its own lightweight socket automation server.
- Primary concerns/domains:
  - Authentication (register/login)
  - Library (books, borrowers, loans, listing/searching, lending)
  - Mathematics (addition service, Fibonacci, Ackermann)
  - Expenses (alcohol allocation)
  - Persistence abstraction over H2 with Flyway migrations
  - Desktop Auto Insurance demo (Swing UI + rules engine + automation socket)
- Key frameworks/tools:
  - Servlet API (Tomcat)
  - H2 database; Flyway for DB migrations
  - Logging: Log4j2
  - Build: Gradle (wrapper included), Gretty for hot-swap/run
  - Testing: JUnit 4/5, Mockito (referenced in docs), Cucumber (BDD), Behave (Python), Selenium, Selenified, PyTest (API tests), JaCoCo (coverage), Pitest (mutation)
  - Static analysis: SonarQube
  - Security scanning: OWASP DependencyCheck
  - Performance: JMeter
  - CI/CD: Jenkins pipeline (Jenkinsfile provided), Zap proxy integration during tests

Components, responsibilities, and key classes

Web application (src/main/java/com/coveros/training)
- authentication
  - LoginServlet, RegisterServlet: HTTP endpoints for user login/registration
  - LoginUtils, RegistrationUtils: business logic for validating credentials, password strength, checking existing users, creating new users
  - domainobjects: User, RegistrationResult, RegistrationStatusEnums, PasswordResult, PasswordResultEnums
  - Responsibilities:
    - Validate input and password quality
    - Check if user exists / register new user
    - Authenticate user credentials

- library
  - Servlets: LibraryRegisterBookServlet, LibraryRegisterBorrowerServlet, LibraryLendServlet, LibraryBookListAvailableServlet, LibraryBookListSearchServlet, LibraryBorrowerListSearchServlet
  - LibraryUtils: core business logic for library operations (register/delete/search/list, lend, lookup loans)
  - domainobjects: Book (id, title), Borrower (id, name), Loan (includes checkoutDate), LibraryActionResults (enum-like outcome codes)
  - Responsibilities:
    - Book and borrower lifecycle: register, delete, list, search (by id/name/title)
    - Lending: create loan if book available and borrower registered; list available books; check loan status and outcomes

- mathematics
  - Servlets: MathServlet (addition API), AckServlet (Ackermann), FibServlet (Fibonacci), MathServlet (composite)
  - Core classes: Ackermann, AckermannIterative, Fibonacci, FibonacciIterative, Calculator, TailRecursive, MathServlet
  - Responsibilities:
    - Expose simple mathematical computations as web endpoints
    - Provide iterative/recursive implementations

- expenses
  - AlcoholCalculator, AlcoholResult, DinnerPrices
  - Responsibilities: calculate allocation of dinner costs between food and alcohol (ratio-based)

- cartesianproduct
  - CartesianProduct: calculates combinations across sets (used in BDD scenarios)

- persistence
  - IPersistenceLayer (interface), PersistenceLayer (implementation), SqlData, ParameterObject, EmptyDataSource, DbServlet
  - NotImplementedException, SqlRuntimeException
  - Responsibilities:
    - Encapsulate all DB access
    - Provide clean/migrate/reset via Flyway (DbServlet exposes DB ops)
    - Central place where SQL runs (H2 in-memory or file-based based on scenario)

- helpers
  - CheckUtils, StringUtils, ServletUtils, AssertionException
  - Responsibilities: validation and common helper functions

- tomcat
  - WebAppListener: lifecycle hook for webapp startup/shutdown

- webapp (src/main/webapp)
  - Static resources: CSS, JS (catalog.js/library.js), HTML pages (index.html, library.html, endpointcatalog.html, dbhelp.html)
  - JSPs: restfulresult.jsp, result.jsp
  - web.xml: servlet mappings and app configuration

Desktop application (desktop_app)
- Domain: Auto Insurance premium/letter/cancellation rules, demo UI
- autoinsurance
  - AutoInsuranceUI: Swing GUI – fields for previous claims (dropdown), age (text field), and “Crunch” button. Displays result label.
  - AutoInsuranceProcessor: rule engine mapping (claims, age) to AutoInsuranceAction:
    - Age 16–25, 0 claims: +$50, no letter
    - Age 26–85, 0 claims: +$25, no letter
    - Age 16–25, 1 claim: +$100, LTR1
    - Age 26–85, 1 claim: +$50, no letter
    - Age 16–25, 2–4 claims: +$400, LTR2
    - Age 26–85, 2–4 claims: +$200, LTR3
    - 5+ claims: cancel policy
    - Else: error
  - AutoInsuranceAction: immutable result (premiumIncreaseDollars, WarningLetterEnum, isPolicyCanceled, isError); factory methods createEmpty(), createErrorResponse()
  - WarningLetterEnum: NONE, LTR1, LTR2, LTR3
  - AutoInsuranceScriptServer: simple socket server (TCP 8000) to drive UI (set/get/click commands, quit); automation interface for tests
  - Tests:
    - AutoInsuranceProcessorTests (parameterized)
    - DesktopUiTests: drives UI via AutoInsuranceScriptClient and asserts label
    - AutoInsuranceActionTests: equals/hashCode/toString and emptiness
- Automation protocol over TCP 8000 (AutoInsuranceScriptServer):
  - Commands:
    - set label <TEXT>, set age <AGE>, set claims <CLAIMS>
    - get label|age|claims
    - click calculate
    - quit (stop server loop)
  - Responses: “OK”, or requested value, or “FAILURE” on exception
- Coverage data client: ExecutionDataClient for JaCoCo remote dump

External interfaces (HTTP API endpoints)
- Base URL: http://localhost:8080/demo (during development via Gretty/Tomcat)
- Documented/observed endpoints (from tests and docs):
  - POST /demo/math
    - Params: item_a (int), item_b (int)
    - Behavior: returns sum, or errors:
      - “Error: only accepts integers”
      - “Error: addend too large - maximum of 2,147,483,647 in a single addend”
      - “Error: sum too large - maximum of (absolute) 2,147,483,647”
  - POST /demo/register
    - Params: username, password
    - Responses include: “successfully registered: true” or error text: “no password provided”, “no username provided”, “already registered” scenarios
  - POST /demo/login
    - Params: username, password
    - Responses include: “access granted” or “no username provided”, “no password provided”, or denial
  - POST /demo/registerbook
    - Params: book (title)
    - Responses include: “SUCCESS” or “ALREADY_REGISTERED_BOOK”
  - POST /demo/registerborrower
    - Params: borrower (name)
    - Responses include: “SUCCESS” or “ALREADY_REGISTERED_BORROWER”
  - POST /demo/lend
    - Params: borrower, book
    - Responses include: “SUCCESS” or “BOOK_CHECKED_OUT”
  - GET /demo/flyway
    - Behavior: resets DB by triggering clean+baseline+migrate (used by tests)
  - UI/static pages:
    - /demo/index.html, /demo/library.html, /demo/endpointcatalog.html, /demo/dbhelp.html
  - H2 console (dev): /demo/console (per docs; use jdbc:h2:mem:training, blank user/pw)
- Additional library endpoints (from servlet names; exact URL patterns set by annotations/web.xml):
  - LibraryBookListAvailableServlet: list available books
  - LibraryBookListSearchServlet: list/search books
  - LibraryBorrowerListSearchServlet: list/search borrowers
  - LibraryLendServlet: lending operation (also reinforced by POST /lend)
  - LibraryRegisterBookServlet, LibraryRegisterBorrowerServlet: registration

Database schemas and data models
- DB engine: H2 (both in-memory and file-based modes used)
  - In-memory used for runtime/Tomcat (jdbc:h2:mem:training)
  - File-based used by tests where persistence across processes may be necessary; file at build/db/training.mv.db (per docs)
- Schema management: Flyway (src/main/resources/db/migration)
  - V1__Create_person_table.sql
  - V2__Rest_of_tables_for_auth_and_library.sql
- Sample data scripts for integration tests (src/integration_test/resources/db_sample_files):
  - v2_empty_schema.sql
  - v2_one_book_one_borrower.sql
  - v2_one_loan.sql
  - v2_one_user.sql
  - v2_three_books_three_borrowers.sql
- Domain data models (Java domainobjects drive schema intent):
  - authentication.domainobjects.User: represents an application user (fields include at least id/name; exact fields not in this chunk)
  - authentication.domainobjects.RegistrationResult (status enum RegistrationStatusEnums; equals/hashCode)
  - authentication.domainobjects.PasswordResult (status enum PasswordResultEnums e.g., INSUFFICIENT_ENTROPY)
  - library.domainobjects.Book: id (int), title (String); equals/hashCode; isEmpty()
  - library.domainobjects.Borrower: id (int), name (String); equals/hashCode; isEmpty()
  - library.domainobjects.Loan: fields include checkoutDate (java.sql.Date) and foreign keys linking book and borrower; equals/hashCode; isEmpty()
  - library.domainobjects.LibraryActionResults: result codes used by LibraryUtils and servlets, e.g., SUCCESS, ALREADY_REGISTERED_BOOK, ALREADY_REGISTERED_BORROWER, NON_REGISTERED_BOOK_CANNOT_BE_DELETED, BORROWER_NOT_REGISTERED, BOOK_CHECKED_OUT, NULL sentinel

Service dependencies and communication patterns
- Web app (Servlets) → Business Utils (Authentication/Library/Math/Expenses) → PersistenceLayer (IPersistenceLayer) → H2 DB
- All DB access centralized in PersistenceLayer (encapsulation/DAO-like pattern)
- Tomcat listener (WebAppListener) initializes application context/lifecycle
- No external microservices or message brokers in this chunk; all intra-process calls
- Desktop app’s UI automation uses a local TCP socket (port 8000) between tests and Swing UI (simple request/response text protocol)

Key business logic and algorithms
- Authentication:
  - Registration flow: validate username/password; password quality check (entropy, etc.); uniqueness constraint; store user; returns RegistrationResult
  - Login flow: verify username/password against stored credentials; respond authenticated/denied with error messages for missing input
- Library:
  - Register/Delete Book or Borrower; uniqueness and existence checks; delete cascades verify associated loans
  - Lending:
    - Preconditions: borrower exists, book exists, not already checked out
    - Creates Loan record with computed checkoutDate (tests indicate end-of-month date e.g., “2018-01-31” from inputs)
    - Lookup loans by book or borrower; list available books (all minus those on loan)
  - Searching/listing:
    - Books by id/title; Borrowers by id/name; list all
- Mathematics:
  - MathServlet: integer addition; error cases for non-integers, overflow limits at 32-bit signed int boundaries
  - Ackermann (recursive and iterative), Fibonacci (recursive, iterative), exposed via servlets
- Expenses:
  - AlcoholCalculator: derives allocation of dinner subtotal/tip/tax into food and alcohol totals and ratio
- Desktop Auto Insurance:
  - Rule table mapping (claims, age) to premium increase; warning letter codes; cancellation threshold at 5+ claims; targeted bounds checking

Configuration and deployment details
- Build/Run:
  - Gradle wrapper; key tasks:
    - apprun: run app with Gretty (embedded Tomcat) on port 8080, context /demo
    - check/test/integrate/jacocoTestReport/pitest/sonarqube/dependencyCheckAnalyze/runAllTests/runApiTests/runBehaveTests/runPerfTests
    - startH2Console: H2 DB web console
  - gradle.properties: memory tuning; chromedriver.path (optional); workers=1; console plain
- Web configuration:
  - web.xml in WEB-INF (servlet mappings, filters)
  - log4j2.xml: console appender, INFO root
- Database:
  - Flyway migration scripts located under src/main/resources/db/migration
  - H2 console exposed (docs indicate /demo/console), JDBC URL: jdbc:h2:mem:training; default empty user/password
- CI/CD (jenkins/Jenkinsfile):
  - Pipeline stages:
    - Build (assemble), Unit Tests (JUnit results), Database Tests (integration tests), BDD Tests (Cucumber), Static Analysis (SonarQube with quality gate), Deploy to Test (Gradle task deployToTestWindowsLocal), Install Python deps via pipenv, heartbeat wait, clear Zap session
    - API Tests (PyTest), UI BDD Tests (Behave + Cucumber HTML report), UI Tests (Java/Selenium + HtmlUnit), Security: Dependency Analysis (OWASP DependencyCheck), Performance Tests (JMeter), Mutation Tests (Pitest), Build Documentation (Javadoc), Collect Zap report (htmlreport endpoint via proxy), Deploy to Prod (no-op sleep)
  - Env: HTTP_PROXY=http://127.0.0.1:9888 to route tests through Zap
  - Reports surfaced via Jenkins sidebar (config documented under docs/ci_and_cd)
- Security and performance tooling:
  - Zap proxy typically on 9888 (in some docs on 8888); Jenkins pipeline clears session and fetches HTML report
  - JMX/Tomcat monitoring (JConsole/JMC) suggestions with port 9999 via setenv.sh/bat (docs)
- Test infrastructure (optional):
  - Python: pipenv-managed dependencies (requests, behave, pyhamcrest, selenium, pytest, behave2cucumber)
  - Chromedriver must be installed and on PATH
  - Selenium Grid support (docs), Selenified properties include hub URL and browser list

Architectural patterns and coding conventions
- Package-by-domain structure: authentication, library, mathematics, expenses, persistence, helpers, tomcat
- Servlet endpoints (web API) separated from business logic utilities
- DAO-like persistence layer abstraction via IPersistenceLayer; explicit SQL types (SqlData, ParameterObject)
- Database migrations via Flyway; clean/migrate available via servlet endpoint for tests
- Favor immutability and avoidance of null (domain objects provide createEmpty()/isEmpty()) as sentinel objects
- Extensive automated testing at multiple layers: unit, integration (DB), API (black-box), UI (functional, BDD), plus non-functionals (performance, static analysis, dependency security, mutation)
- Logging via SLF4J + Log4j2, INFO default

Detailed interfaces and data contract examples (as observable)
- POST /demo/math (form-encoded)
  - Request: item_a=3&item_b=5
  - Response: HTML (text/html) containing the sum as text
  - Errors:
    - Non-integers: “Error: only accepts integers”
    - Single addend > 2,147,483,647 (absolute): “Error: addend too large - maximum of 2,147,483,647 in a single addend”
    - Sum absolute > 2,147,483,647: “Error: sum too large - maximum of (absolute) 2,147,483,647”
- POST /demo/register (form-encoded)
  - Request: username, password
  - Responses indicate registration outcome; success string “successfully registered: true”; otherwise explicit human-readable errors
- POST /demo/login (form-encoded)
  - Request: username, password
  - Responses: “access granted” or explicit failure reason (missing fields, not registered)
- Library:
  - POST /demo/registerbook: book=title; “SUCCESS” or “ALREADY_REGISTERED_BOOK”
  - POST /demo/registerborrower: borrower=name; “SUCCESS” or “ALREADY_REGISTERED_BORROWER”
  - POST /demo/lend: borrower,book; “SUCCESS” or “BOOK_CHECKED_OUT”
- Maintenance:
  - GET /demo/flyway: resets DB (used by tests to ensure deterministic state)

Testing suites (for traceability and decomposition impact)
- Unit (src/test/java): utilities, domain objects, servlet units (e.g., AckServletTests, DbServletTests, LibraryUtilsTests)
- Integration (src/integration_test/java): PersistenceLayerTests using H2 with sample SQL datasets
- BDD (src/bdd_test/java + resources): auth (login/register), library scenarios (register/delete/list/search/lend), math (Ackermann/Fibonacci), expenses (alcohol). StepDefs use PersistenceLayer to reset DB per scenario
- API tests (src/api_tests): Python + requests, drives public HTTP API
- UI tests:
  - Behave (src/ui_tests/behave): feature-driven UI flows (login, librarian flows) via Selenium
  - Java Selenium (src/ui_tests/java): SeleniumTests, HtmlUnitTests
  - JS (src/ui_tests/js): mocha spec
  - C# example project
  - Selenified tests (src/selenified_tests/java)
- Desktop app tests (desktop_app/src/test): headless automation via socket client to Swing UI

Operational environment expectations (from docs)
- Local dev run: ./gradlew apprun -> http://localhost:8080/demo
- H2 console available via app route (/demo/console); JDBC: jdbc:h2:mem:training; blank credentials
- Jenkins pipeline assumes SonarQube (http://localhost:9000), Zap proxy, JMeter, Python env, Chromedriver
- Optional VM setups documented for Jenkins box and UI test box with VirtualBox Host-only networking

Potential microservice decomposition signals (for future analysis)
- Natural domain seams:
  - Authentication service (register/login/password policy) + user store
  - Library service (book/borrower/loan) + lending rules, listings/search
  - Math service (stateless compute endpoints)
  - Expenses service (stateless compute)
  - Persistence abstraction could be consolidated into service-specific data access layers; current monolith has a single PersistenceLayer
- Data boundaries:
  - Auth tables (users/person) are separate from Library tables (books, borrowers, loans)
- API contracts are simple form-encoded POSTs/GETs with string payloads and HTML/string responses; would require normalization to JSON for service separation
- Stateful dependencies: lending reads/writes loans; DB reset endpoint is used by tests (would need test harness orchestration if split)

Known ports and network interactions
- Web app: 8080 (HTTP)
- H2 console: served under the app (URL documented)
- Desktop app automation server: TCP 8000
- Zap proxy during tests: 9888 (some setup docs show 8888)
- JMX (optional monitoring in docs): 9999
- Jenkins pipeline communicates with SonarQube (9000) and Zap

Configuration artifacts
- gradle.properties: JVM memory, console output, chromedriver.path (optional), workers=1
- log4j2.xml (app and desktop_app): Console appender with PatternLayout, INFO root
- Flyway migrations present under resources/db/migration
- Jenkinsfile defines full CI/CD flow including artifacts and reports
- Webapp static resources: catalog.css/js; library.html/js define UI-side behavior (not detailed in this chunk)

Licensing
- MIT License (LICENSE)

This summary covers the structural components, endpoints, data models, dependencies, business logic, and deployment/test orchestration present in chunk 1, sufficient to inform microservice boundary and integration analysis.